format_version: 4
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

app:
  envs:
    - BITRISE_STEP_VERSION: "0.0.2"
    - BITRISE_JIRA_USER_NAME: $BITRISE_JIRA_USER_NAME
    - BITRISE_JIRA_API_TOKEN: $BITRISE_JIRA_API_TOKEN
    - BITRISE_JIRA_BASE_URL: $BITRISE_JIRA_BASE_URL
    - BITRISE_JIRA_STATUS: $BITRISE_JIRA_STATUS
    - BITRISE_JIRA_PROJECTS: $BITRISE_JIRA_PROJECTS
    - BITRISE_JIRA_LABELS: $BITRISE_JIRA_LABELS

workflows:
  test:
    steps:
      - change-workdir:
          title: Switch working dir to ./_tmp dir
          inputs:
            - path: ./_tmp
            - is_create_path: true
      - path::./:
          title: Env Vars
          inputs:
            - user_name: ${BITRISE_JIRA_USER_NAME}
            - api_token: ${BITRISE_JIRA_API_TOKEN}
            - labels: ${BITRISE_JIRA_LABELS}
            - status: ${BITRISE_JIRA_STATUS}
            - projects: ${BITRISE_JIRA_PROJECTS}
            - base_url: ${BITRISE_JIRA_BASE_URL}
      - script:
          inputs:
            - content: |
                #!/bin/bash
                echo "This output was generated by the Step (JIRA_TICKETS_NAME): $JIRA_TICKETS_NAME"
                echo "This output was generated by the Step (JIRA_TICKETS_SUMMARY): $JIRA_TICKETS_SUMMARY"


  # ----------------------------------------------------------------
  # --- workflows to Share this step into a Step Library
  dep-update:
    title: Dep update
    description: |
      Used for updating bitrise dependencies with dep
    steps:
      - script:
          title: Dependency update
          inputs:
            - content: |-
                #!/bin/bash
                set -ex
                go get -u -v github.com/golang/dep/cmd/dep
                dep ensure -v
                dep ensure -v -update
  audit-this-step:
    steps:
      - script:
          inputs:
            - content: |-
                #!/bin/bash
                set -ex
                stepman audit --step-yml ./step.yml