format_version: 4
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

app:
  envs:
    - BITRISE_STEP_VERSION: "1.0"
    - BITRISE_JIRA_USER_NAME: $BITRISE_JIRA_USER_NAME
    - BITRISE_JIRA_API_TOKEN: $BITRISE_JIRA_API_TOKEN
    - BITRISE_JIRA_BASE_URL: $BITRISE_JIRA_BASE_URL
    - BITRISE_JIRA_STATUS: $BITRISE_JIRA_STATUS
    - BITRISE_JIRA_PROJECTS: $BITRISE_JIRA_PROJECTS
    - BITRISE_JIRA_PLATFORM: $BITRISE_JIRA_PLATFORM

workflows:
  test:
    steps:
      - path::./:
          title: Env Vars
          inputs:
            - user_name: ${BITRISE_JIRA_USER_NAME}
            - api_token: ${BITRISE_JIRA_API_TOKEN}
            - base_url: ${BITRISE_JIRA_BASE_URL}
            - status: ${BITRISE_JIRA_STATUS}
            - projects: ${BITRISE_JIRA_PROJECTS}
            - platform: ${BITRISE_JIRA_PLATFORM}
      - script:
          title: Output (generated by the Step) tests
          inputs:
            - content: |-
                echo "-> BITRISE_PUBLIC_INSTALL_PAGE_URL: ${BITRISE_PUBLIC_INSTALL_PAGE_URL}"
                echo "-> BITRISE_PUBLIC_INSTALL_PAGE_URL_MAP: ${BITRISE_PUBLIC_INSTALL_PAGE_URL_MAP}"


  dep-update:
    title: Dep update
    description: |
      Used for updating bitrise dependencies with dep
    steps:
      - script:
          title: Dependency update
          inputs:
            - content: |-
                #!/bin/bash
                set -ex
                go get -u -v github.com/golang/dep/cmd/dep
                dep ensure -v
                dep ensure -v -update
  audit-this-step:
    steps:
      - script:
          inputs:
            - content: |-
                #!/bin/bash
                set -ex
                stepman audit --step-yml ./step.yml